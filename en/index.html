<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CoreWear</title>
    <meta name="description" content="CoreWear produces private-label apparel fast: quotes in 24h, samples in 7&ndash;10 days, and production start from 14&ndash;21 days (model-dependent). In-house production control, QC gates, and clear timelines." />

    <!-- hreflang: DE/EN + x-default -->
    <link rel="alternate" href="https://corewear.pro/de/" hreflang="de" />
    <link rel="alternate" href="https://corewear.pro/en/" hreflang="en" />
    <link rel="alternate" href="https://corewear.pro/en/" hreflang="x-default" />

    <!-- canonical -->
    <link rel="canonical" href="https://corewear.pro/en/" />

    <!-- Open Graph / Twitter (simple, safe defaults) -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="CoreWear">
    <meta property="og:title" content="CoreWear — B2B Apparel Manufacturing in Record Time (MOQ 100)">
    <meta property="og:description" content="Quotes in 24h, samples in 7&ndash;10 days, production start from 14&ndash;21 days. In-house production control, QC gates, clear timelines.">
    <meta property="og:url" content="https://corewear.pro/en/">
    <meta property="og:image" content="https://corewear.pro/assets/img/Logo.png">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="stylesheet" href="/assets/css/index.css" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <meta name="referrer" content="strict-origin-when-cross-origin">
  </head>
  <body>
    <header>
      <div class="header-bar">
        <a href="/en/" class="brand">
          <img id="logo" src="/assets/img/Logo.png" alt="CoreWear logo" />
        </a>

        <!-- ✨ Hamburger button (mobile only) -->
        <button class="hamburger" aria-label="Open menu" aria-controls="mobile-nav" aria-expanded="false">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"/>
          </svg>
        </button>

        <!-- Main navigation (off-canvas on mobile) -->
        <nav id="mobile-nav" class="main-nav">
          <a href="/en/" class="active" aria-current="page">Home</a>
          <a href="/en/products/">Products</a>
          <a href="/en/process/">Process</a>
          <a href="/en/about/">About</a>
          <a href="/en/faq/">FAQ</a>
          <a href="/en/contact/" class="btn">Contact</a>

          <!-- ▶️ Language switch (DE | EN) – image variant -->
          <div class="lang-switch" role="group" aria-label="Language">
            <a class="lang-link" href="/de/" data-lang="de" role="button" aria-pressed="false" title="Deutsch">
              <img src="/assets/img/de.jpg" width="36" height="24" alt="Deutsch">
            </a>
            <a class="lang-link" href="/en/" data-lang="en" role="button" aria-pressed="true" aria-current="true" title="English">
              <img src="/assets/img/en.jpg" width="36" height="24" alt="English">
            </a>
          </div>
        </nav>
      </div>
    </header>

    <!-- Overlay for the off-canvas menu -->
    <div class="nav-overlay" hidden></div>

    <main id="home">
      <!-- HERO -->
      <section class="hero">
        <div class="hero-card">
          <h1>Apparel manufacturing in record time<br/>from <span style="color:rgb(23, 103, 250)">100 units</span></h1>
          <p class="sub">
            Quote in <strong>24&nbsp;hours</strong>, sample in <strong>7&ndash;10&nbsp;days</strong>, production start from <strong>14&ndash;21&nbsp;days</strong> &ndash; depending on the model.
          </p>
          <div class="badges">
            <span class="badge">QC Gates &amp; AQL</span>
            <span class="badge">Private Label / OEM</span>
            <span class="badge">In-house Production Control</span>
            <span class="badge">Industrial Quality</span>
          </div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
            <a href="#contact" class="btn primary">Start an inquiry in 60s</a>
            <a href="/en/products/" class="btn ghost">Products</a>
          </div>
          <p class="notice">Minimum order quantity (MOQ): 100 units per style/color.</p>
        </div>
      </section>

      <!-- SPEED-PROMISE -->
      <section class="grid cols-1" style="max-width:var(--max);margin:24px auto;padding:0 20px">
        <article class="card" style="display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap">
          <div>
            <h3>Our promise</h3>
            <p class="muted">
              Binding timelines &ndash; transparent for every milestone. If a date unexpectedly shifts, we inform you proactively and adjust the plan.
            </p>
          </div>
          <a href="/en/process/" class="btn ghost">Process &amp; SLAs</a>
        </article>
      </section>

      <!-- QUICK-LINK CARDS -->
      <div class="section-title" style="justify-content:center;text-align:center">
        <h2>Jump right in</h2>
        <span class="muted">Pick a topic &ndash; details are on the subpages.</span>
      </div>

      <section class="grid cols-3">
        <a class="card" href="/en/products/" style="display:block">
          <h3>Products</h3>
          <p class="muted">Tops, bottoms, workwear, dresses, jackets, activewear &ndash; with fabric &amp; production details.</p>
        </a>
        <a class="card" href="/en/process/" style="display:block">
          <h3>Process</h3>
          <p class="muted">5 steps with clear SLAs: quote ≤ 24h, samples 7&ndash;10 days, production start from 14&ndash;21 days.</p>
        </a>
        <a class="card" href="/en/about/" style="display:block">
          <h3>About</h3>
          <p class="muted">Team, values, how we work &ndash; why CoreWear is the right partner.</p>
        </a>
      </section>

      <!-- USP TEASER -->
      <div class="section-title" style="justify-content:center;text-align:center">
        <h2>Why CoreWear?</h2>
        <span class="muted">Predictable quality &ndash; clear timelines &ndash; fair terms.</span>
      </div>
      <section class="grid cols-4">
        <article class="card"><h3>Scalable</h3><p class="muted">Series production from 100 units &ndash; reliable on reorders.</p></article>
        <article class="card"><h3>Quality</h3><p class="muted">QC gates, AQL inspections, documented lots.</p></article>
        <article class="card"><h3>Speed</h3><p class="muted">From quote to production start with fixed SLAs.</p></article>
        <article class="card"><h3>Branding</h3><p class="muted">Hangtags, care labels, packaging &ndash; all in one place.</p></article>
      </section>

      <!-- CONTACT FORM -->
      <div class="section-title" id="contact" style="justify-content:center;text-align:center">
        <h2>Contact &amp; Inquiry</h2>
        <span class="muted">Orders from 100 units &ndash; reply within <strong>12 business hours</strong>, quote ≤ <strong>24h</strong>.</span>
      </div>

      <section class="contact">
        <form id="contactForm" class="card" novalidate>
          <h3>Your request</h3>

          <div class="field">
            <label for="type">Inquiry type</label>
            <select id="type" name="type" required>
              <option value="Question">General question</option>
              <option value="Order">Order inquiry (from 100 units)</option>
            </select>
          </div>

          <div class="field">
            <label for="name">Name*</label>
            <input id="name" name="name" required autocomplete="name" />
          </div>

          <div class="field">
            <label for="company">Company</label>
            <input id="company" name="company" autocomplete="organization" />
          </div>

          <div class="field">
            <label for="email">Email*</label>
            <input id="email" name="email" type="email" required autocomplete="email" inputmode="email" />
          </div>

          <div class="field">
            <label for="phone">Phone (optional)</label>
            <input id="phone" name="phone" type="tel" placeholder="e.g., +49 ..." autocomplete="tel" inputmode="tel" pattern="[\d\s()+-]{6,}" />
          </div>

          <!-- Contact preference -->
          <div class="field">
            <fieldset class="contact-pref" style="border:0;padding:0;margin:0">
              <legend style="font-size:14px;color:#c8d2f0;margin-bottom:6px">How should we contact you?</legend>
              <label style="display:inline-flex;align-items:center;gap:8px;margin-right:16px">
                <input type="radio" name="contact_pref" value="Email" checked>
                <span>Email</span>
              </label>
              <label style="display:inline-flex;align-items:center;gap:8px">
                <input type="radio" name="contact_pref" value="Phone">
                <span>Phone</span>
              </label>
              <small class="hint" style="display:block;margin-top:6px">We&rsquo;ll use your preferred channel.</small>
            </fieldset>
          </div>

          <!-- Order fields (toggle) -->
          <div id="orderFields" style="display:grid;gap:12px">
            <div class="field">
              <label for="product">Product type</label>
              <select id="product" name="product">
                <option>Jersey</option>
                <option>Workwear</option>
                <option>Streetwear</option>
                <option>Hoodies / Sweats</option>
                <option>T-Shirts</option>
                <option>Jackets</option>
                <option>Kidswear</option>
                <option>Other</option>
              </select>
            </div>

            <div class="field">
              <label for="qty">Planned quantity*</label>
              <input id="qty" name="qty" type="number" min="1" placeholder="e.g., 2500" />
              <span class="hint">MOQ 100 per style/color</span>
            </div>

            <div class="field">
              <label for="target_price">Target price (optional)</label>
              <input id="target_price" name="target_price" type="text" placeholder="e.g., €12.50 / unit" />
            </div>

            <div class="field">
              <label for="timeline">Desired timeline (optional)</label>
              <input id="timeline" name="timeline" type="text" placeholder="e.g., delivery in 2&ndash;4 weeks" />
            </div>
          </div>

          <!-- Message -->
          <div class="field">
            <label for="message"><span id="messageLabel">Message*</span></label>
            <textarea id="message" name="message" rows="4"
              placeholder="Tell us your request or additional details"
              required></textarea>
          </div>

          <!-- Attachments -->
          <div class="field">
            <label for="files-main">Attachments (optional)</label>

            <input
              id="files-main"
              type="file"
              multiple
              accept=".pdf,.jpg,.jpeg,.png,.webp,.svg,.ai,.psd,.tif,.tiff,.eps,.heic"
            />

            <span class="hint upload-hint">
              Up to 5&nbsp;MB total, max 5&nbsp;MB per file. For larger assets, please share a link (Drive/Dropbox).
            </span>

            <!-- Hidden container for real file inputs -->
            <div id="file-inputs" style="display:none;"></div>

            <!-- Visible list -->
            <ul id="file-list" class="file-list"></ul>
          </div>

          <!-- Privacy -->
          <div class="field privacy-field">
            <label for="privacy" class="privacy-label">
              <input type="checkbox" id="privacy" required />
              <span>
                I&rsquo;ve read and agree to the
                <a href="/en/privacy/" class="underline" rel="noopener">Privacy Policy</a>.
              </span>
            </label>
          </div>

          <!-- Honeypot -->
          <div class="hp" style="display:none;">
            <label for="ignore_this">Leave this field empty</label>
            <input type="text" id="ignore_this" name="ignore_this" />
          </div>

          <button class="btn primary" type="submit">Send</button>
          <p id="formStatus" class="hint" role="status" aria-live="polite"></p>
        </form>

        <!-- Contact info -->
        <aside class="card">
          <h3>Direct contact</h3>
          <ul class="list">
            <div class="info-slot">
              <span class="chip">Email</span>
              <a class="underline" href="mailto:hello@corewear.pro">hello@corewear.pro</a>
            </div>
            <li>Diren Bulut<br>Core Wear<br>Bensbergerstraße&nbsp;192<br>51503 Rösrath</li>
          </ul>

          <p class="notice">
            Tip: The more info you share (quantity, target price, materials, reference images), the faster we can quote.
          </p>
        </aside>
      </section>
    </main>

    <footer>
      <div class="wrap">
        <small>© <span id="y"></span> CoreWear</small>
        <div style="display:flex;gap:14px">
          <a href="/en/legal/">Legal Notice</a>
          <a href="/en/privacy/">Privacy</a>
        </div>
      </div>
    </footer>

    <script>
    /* ===============================
      CoreWear – Frontend Script (v8) [EN]
      =============================== */

    // Footer year
    const yEl = document.getElementById('y');
    if (yEl) yEl.textContent = new Date().getFullYear();

    // --- Elements ---
    const form         = document.getElementById('contactForm');
    const statusEl     = document.getElementById('formStatus');
    const typeSel      = document.getElementById('type');
    const orderWrap    = document.getElementById('orderFields');
    const qtyInput     = document.getElementById('qty');
    const message      = document.getElementById('message');
    const messageLabel = document.getElementById('messageLabel');
    const privacyCb    = document.getElementById('privacy');

    const emailEl      = document.getElementById('email');
    const phoneEl      = document.getElementById('phone');
    const contactRadios= form.querySelectorAll('input[name="contact_pref"]');

    const filePicker   = document.getElementById('files-main');
    const fileList     = document.getElementById('file-list');
    const fileBox      = document.getElementById('file-inputs');

    // --- Error box above privacy field ---
    const privacyField = document.querySelector('.privacy-field');
    let errorBox = null;
    function ensureErrorBox() {
      if (!errorBox) {
        errorBox = document.createElement('div');
        errorBox.id = 'formErrors';
        errorBox.setAttribute('role','alert');
        errorBox.style.display = 'none';
        errorBox.style.margin = '0 0 12px 0';
        errorBox.style.color = '#ffb7b7';
        errorBox.style.fontSize = '14px';
        if (privacyField && privacyField.parentNode) {
          privacyField.parentNode.insertBefore(errorBox, privacyField);
        } else {
          form.insertBefore(errorBox, form.firstChild);
        }
      }
      return errorBox;
    }
    function renderErrors(errs) {
      const box = ensureErrorBox();
      if (!errs || errs.length === 0) {
        box.innerHTML = '';
        box.style.display = 'none';
        return;
      }
      const ul = document.createElement('ul');
      ul.style.margin = '0';
      ul.style.paddingLeft = '18px';
      ul.style.listStyle = 'disc';
      errs.forEach(msg => {
        const li = document.createElement('li');
        li.textContent = msg;
        ul.appendChild(li);
      });
      box.innerHTML = '';
      box.appendChild(ul);
      box.style.display = 'block';
    }
    function clearErrors() { renderErrors([]); }

    // --- Endpoints & limits ---
    const FORM_ENDPOINTS = {
      Order:    'https://formsubmit.co/ajax/orders@corewear.pro',
      Question: 'https://formsubmit.co/ajax/hello@corewear.pro'
    };
    const FORM_ENDPOINTS_RAW = {
      Order:    'https://formsubmit.co/orders@corewear.pro',
      Question: 'https://formsubmit.co/hello@corewear.pro'
    };

    const MAX_TOTAL_MB = 5; // total
    const MAX_FILE_MB  = 5; // per file
    const toMB = b => b / (1024 * 1024);

    const allowedExts = ['pdf','jpg','jpeg','png','webp','svg','ai','psd','tif','tiff','eps','heic'];
    const archiveExts = ['zip','7z','rar'];
    const blockedMimes = [
      'application/zip','application/x-zip-compressed','application/x-7z-compressed','application/x-rar-compressed','application/vnd.rar'
    ];

    document.querySelectorAll('.upload-hint').forEach(el => {
      el.textContent = 'Up to 5 MB total, max 5 MB per file. For larger assets, please share a link (Drive/Dropbox).';
    });

    // --- Required fields / UI toggle ---
    function toggleOrderFields() {
      const isOrder = typeSel.value === 'Order';
      orderWrap.style.display = isOrder ? 'grid' : 'none';
      qtyInput.required = isOrder;
      message.required  = !isOrder;
      messageLabel.textContent = isOrder ? 'Additional information (optional)' : 'Message*';
    }
    typeSel.addEventListener('change', () => { toggleOrderFields(); clearErrors(); });

    (function ensureDefaultType() {
      const v = (typeSel && typeSel.value) || '';
      if (v !== 'Order' && v !== 'Question') typeSel.value = 'Question';
      toggleOrderFields();
    })();

    // Contact preference drives required field
    function syncContactRequired() {
      const pref = (form.querySelector('input[name="contact_pref"]:checked') || {}).value;
      emailEl.required = false;
      phoneEl.required = false;
      if (pref === 'Email') emailEl.required = true;
      else if (pref === 'Phone') phoneEl.required = true;
    }
    contactRadios.forEach(r => r.addEventListener('change', () => { syncContactRequired(); clearErrors(); }));
    syncContactRequired();

    /* Files – keep as real inputs for FormSubmit transport */
    let attachCounter = 0;
    function getStoredFileInputs() {
      return Array.from(fileBox.querySelectorAll('input[type="file"][data-attachment="1"]'));
    }
    function getTotalBytes() {
      return getStoredFileInputs().reduce((sum, inp) => {
        const fl = inp.files;
        return sum + (fl && fl[0] ? fl[0].size : 0);
      }, 0);
    }
    function refreshHasAttachmentsFlag() {
      const has = getStoredFileInputs().length > 0;
      if (has) form.classList.add('has-attachments');
      else form.classList.remove('has-attachments');
    }
    function renderList() {
      const inputs = getStoredFileInputs();
      fileList.innerHTML = '';
      if (inputs.length === 0) {
        fileList.style.display = 'none';
        refreshHasAttachmentsFlag();
        return;
      }
      fileList.style.display = 'block';
      refreshHasAttachmentsFlag();

      inputs.forEach((inp, idx) => {
        const f = inp.files && inp.files[0];
        if (!f) return;
        const li = document.createElement('li');
        li.className = 'file-row';
        li.style.display = 'flex';
        li.style.alignItems = 'center';
        li.style.gap = '8px';
        li.style.margin = idx === 0 ? '0 0 6px 0' : '6px 0 0 0';

        const rm = document.createElement('button');
        rm.type = 'button';
        rm.textContent = '✕';
        rm.className = 'rm';
        rm.title = 'Remove';
        rm.style.border = '0';
        rm.style.background = 'none';
        rm.style.cursor = 'pointer';
        rm.setAttribute('aria-label', `Remove file: ${f.name}`);
        rm.addEventListener('click', () => {
          inp.remove();
          renderList();
          clearErrors();
          statusEl.textContent = '';
          statusEl.style.color = '';
        });

        const name = document.createElement('span');
        name.textContent = f.name;

        const size = document.createElement('small');
        size.className = 'muted';
        size.textContent = `(${toMB(f.size).toFixed(2)} MB)`;

        li.appendChild(rm);
        li.appendChild(name);
        li.appendChild(size);
        fileList.appendChild(li);
      });
    }
    fileList.style.display = 'none';
    refreshHasAttachmentsFlag();

    const seenFiles = new Set();
    function fileKey(file) { return (file.name || '_') + '_' + (file.size || 0); }

    function storeSingleFile(file) {
      const dt = new DataTransfer();
      dt.items.add(file);
      const inp = document.createElement('input');
      inp.type = 'file';
      inp.name = `attachment_${++attachCounter}`;
      inp.setAttribute('data-attachment','1');
      inp.style.display = 'none';
      inp.files = dt.files;
      fileBox.appendChild(inp);
    }

    filePicker.addEventListener('change', () => {
      clearErrors();
      statusEl.textContent = '';
      statusEl.style.color = '';

      const picked = Array.from(filePicker.files || []);
      if (picked.length === 0) return;

      let total = getTotalBytes();
      const errors = [];

      for (const f of picked) {
        const name = f.name || '';
        const ext = (name.includes('.') ? name.split('.').pop() : '').toLowerCase();
        const k = fileKey(f);

        if (seenFiles.has(k)) { errors.push(`Already added: ${name}`); continue; }
        if (['zip','7z','rar'].includes(ext)) { errors.push(`Archives cannot be submitted. Please share as a link (Drive/Dropbox): ${name}`); continue; }
        if (!['pdf','jpg','jpeg','png','webp','svg','ai','psd','tif','tiff','eps','heic'].includes(ext)) { errors.push(`Unsupported file type: ${name}. Allowed: .pdf .jpg .jpeg .png .webp .svg .ai .psd .tif .tiff .eps .heic`); continue; }

        const sizeMB = toMB(f.size);
        if (sizeMB > 5) { errors.push(`File too large (> 5 MB): ${name}`); continue; }
        if (toMB(total + f.size) > 5) { errors.push(`Total size > 5 MB — not added: ${name}`); continue; }

        storeSingleFile(f);
        seenFiles.add(k);
        total += f.size;
      }

      renderList();
      if (errors.length) renderErrors(errors);
      filePicker.value = '';
    });

    function validateAllFilesBeforeSubmit() {
      const errors = [];
      const totalMB = toMB(getTotalBytes());
      if (totalMB > 5) errors.push('Total size of attachments exceeds 5 MB.');
      const inputs = getStoredFileInputs();
      for (const inp of inputs) {
        const f = inp.files && inp.files[0];
        if (!f) continue;
        if (toMB(f.size) > 5) errors.push(`A file is larger than 5 MB: ${f.name}`);
      }
      if (errors.length) { renderErrors(errors); return false; }
      return true;
    }

    function ensureHiddenIframe() {
      let ifr = document.getElementById('fs-transport');
      if (!ifr) {
        ifr = document.createElement('iframe');
        ifr.name = 'fs-transport';
        ifr.id = 'fs-transport';
        ifr.style.display = 'none';
        document.body.appendChild(ifr);
      }
      return ifr;
    }

    let submitting = false;
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (submitting) return;
      submitting = true;
      clearErrors();
      statusEl.textContent = 'Sending…';
      statusEl.style.color = '';

      syncContactRequired();

      const pref = (form.querySelector('input[name="contact_pref"]:checked') || {}).value;
      const softErrs = [];
      if (pref === 'Email' && !emailEl.value.trim()) softErrs.push('Please enter your email.');
      if (pref === 'Phone' && !phoneEl.value.trim()) softErrs.push('Please enter your phone number.');
      if (softErrs.length) { renderErrors(softErrs); statusEl.textContent = ''; submitting = false; return; }

      if (!form.checkValidity()) { form.reportValidity(); renderErrors(['Please check the required fields.']); statusEl.textContent = ''; submitting = false; return; }
      if (!privacyCb.checked) {
        renderErrors(['Please confirm the Privacy Policy.']);
        statusEl.textContent = '';
        const label = document.querySelector('.privacy-label');
        if (label) label.scrollIntoView({ behavior: 'smooth', block: 'center' });
        submitting = false;
        return;
      }
      if (!validateAllFilesBeforeSubmit()) { statusEl.textContent = ''; submitting = false; return; }

      const fd = new FormData(form);
      const payload = Object.fromEntries(fd.entries());

      if (payload.ignore_this || payload.website) { renderErrors(['Spam detected. Message not sent.']); statusEl.textContent = ''; submitting = false; return; }

      const isOrder = (payload.type === 'Order');
      const qtyNum  = Number(payload.qty || 0);
      if (isOrder && (!qtyNum || qtyNum < 100)) { renderErrors(['Please note the MOQ of 100 units for order inquiries.']); statusEl.textContent = ''; submitting = false; return; }

      const subj = `[${isOrder ? 'Order' : 'Question'}] ${payload.company || '-'} &ndash; ${payload.name || '-'}`;
      fd.set('_subject', subj);
      fd.set('_template', 'table');
      fd.set('_captcha', 'false');
      if (payload.email) fd.set('_replyto', payload.email);

      const hasAttachments = getStoredFileInputs().length > 0;
      const submitBtn = form.querySelector('button[type="submit"]');
      if (submitBtn) { submitBtn.disabled = true; submitBtn.setAttribute('aria-busy', 'true'); }

      if (hasAttachments) {
        try {
          const mirror = (name) => {
            if (form.querySelector(`input[type="hidden"][name="${name}"]`)) return;
            const h = document.createElement('input');
            h.type = 'hidden'; h.name = name; h.value = fd.get(name) || '';
            form.appendChild(h);
          };
          ['_subject','_template','_captcha','_replyto'].forEach(mirror);

          const ifr = ensureHiddenIframe();
          const endpoint = (isOrder ? 'https://formsubmit.co/orders@corewear.pro' : 'https://formsubmit.co/hello@corewear.pro');

          const chosenType = typeSel.value;
          const cleanup = () => {
            setTimeout(() => {
              form.reset();
              typeSel.value = chosenType;
              toggleOrderFields();
              getStoredFileInputs().forEach(inp => inp.remove());
              seenFiles.clear();
              renderList();
              clearErrors();
            }, 400);
            if (submitBtn) { submitBtn.disabled = false; submitBtn.removeAttribute('aria-busy'); }
            submitting = false;
          };

          const onLoad = () => {
            statusEl.textContent = 'Thanks! We&rsquo;ll get back to you within 12 business hours — quote within ≤ 24h.';
            statusEl.style.color = '#9fe2b0';
            ifr.removeEventListener('load', onLoad);
            form.removeAttribute('target');
            form.removeAttribute('action');
            form.removeAttribute('enctype');
            form.removeAttribute('method');
            cleanup();
          };
          ifr.addEventListener('load', onLoad);

          form.setAttribute('target', 'fs-transport');
          form.setAttribute('action', endpoint);
          form.setAttribute('method', 'POST');
          form.setAttribute('enctype', 'multipart/form-data');
          form.submit();
        } catch (err) {
          renderErrors(['Error while sending attachments. Please try again, or email hello@corewear.pro.']);
          statusEl.textContent = '';
          statusEl.style.color = '#ffb7b7';
          if (submitBtn) { submitBtn.disabled = false; submitBtn.removeAttribute('aria-busy'); }
          submitting = false;
        }
        return;
      }

      try {
        const endpointAjax = (isOrder ? 'https://formsubmit.co/ajax/orders@corewear.pro' : 'https://formsubmit.co/ajax/hello@corewear.pro');
        const res = await fetch(endpointAjax, { method: 'POST', body: fd, headers: { 'Accept': 'application/json' } });
        if (res.ok) {
          statusEl.textContent = 'Thanks! We&rsquo;ll get back to you within 12 business hours — quote within ≤ 24h.';
          statusEl.style.color = '#9fe2b0';
          const chosenType = typeSel.value;
          setTimeout(() => {
            form.reset();
            typeSel.value = chosenType;
            toggleOrderFields();
            getStoredFileInputs().forEach(inp => inp.remove());
            seenFiles.clear();
            renderList();
            clearErrors();
          }, 400);
        } else {
          let msg = 'Error sending. Please email hello@corewear.pro.';
          try { const data = await res.json(); if (data && data.message) msg = data.message; } catch(_){}
          renderErrors([msg]);
          statusEl.textContent = '';
        }
      } catch (err) {
        renderErrors(['Network error during send. Please try again later or email hello@corewear.pro.']);
        statusEl.textContent = '';
      } finally {
        if (submitBtn) { submitBtn.disabled = false; submitBtn.removeAttribute('aria-busy'); }
        submitting = false;
      }
    }, { capture: true });

    // Filled field visuals
    (function filledVisuals() {
      const BG_DEFAULT = '#0f1421';
      const BD_DEFAULT = '#283246';
      const BG_FILLED  = '#141b2a';
      const BD_FILLED  = '#3a4864';
      const TXT_COLOR  = (getComputedStyle(document.documentElement)
                          .getPropertyValue('--txt') || '#eaf2ff').trim();

      const skip = el => el.type === 'checkbox' || el.type === 'radio' || el.type === 'file' || el.id === 'files-main';
      const isFilled = el => {
        if (el.tagName === 'SELECT') return el.value !== '' && el.selectedIndex !== -1;
        return (el.value != null && String(el.value).trim() !== '');
      };
      const setVisual = (el, on) => {
        if (skip(el)) return;
        const isSelect = el.tagName === 'SELECT';
        el.style.transition = 'background-color .25s ease, border-color .25s ease';
        el.style.color = on ? TXT_COLOR : 'rgba(234,242,255,0.6)';
        el.style.webkitTextFillColor = el.style.color;
        el.style.backgroundColor = on ? BG_FILLED : BG_DEFAULT;
        el.style.borderColor = on ? BD_FILLED : BD_DEFAULT;
        el.style.boxShadow = on ? (isSelect ? 'none' : `0 0 0 1000px ${BG_FILLED} inset`) : 'none';
      };

      const ctrls = form.querySelectorAll('input, textarea, select');
      const refreshAll = () => ctrls.forEach(el => setVisual(el, isFilled(el)));

      ctrls.forEach(el => {
        if (skip(el)) return;
        setVisual(el, isFilled(el));
        el.addEventListener('input',  () => setVisual(el, isFilled(el)));
        el.addEventListener('change', () => setVisual(el, isFilled(el)));
        el.addEventListener('blur',   () => setVisual(el, isFilled(el)));
      });

      form.addEventListener('reset', () => setTimeout(() => { refreshAll(); }, 0));
      window.addEventListener('pageshow', refreshAll);
      setTimeout(refreshAll, 120);
      setTimeout(refreshAll, 600);
      setTimeout(refreshAll, 1500);
    })();

    if ('scrollRestoration' in history) { history.scrollRestoration = 'manual'; }
    window.addEventListener('beforeunload', () => window.scrollTo(0, 0));

    /* ===== Hamburger menu control ===== */
    (function () {
      const btn = document.querySelector('.hamburger');
      const nav = document.getElementById('mobile-nav');
      const overlay = document.querySelector('.nav-overlay');

      if (!btn || !nav || !overlay) return;

      function openMenu() {
        document.body.classList.add('menu-open');
        overlay.hidden = false;
        btn.setAttribute('aria-expanded', 'true');
        const firstLink = nav.querySelector('a');
        if (firstLink) firstLink.focus({preventScroll:true});
      }
      function closeMenu() {
        document.body.classList.remove('menu-open');
        overlay.hidden = true;
        btn.setAttribute('aria-expanded', 'false');
        btn.focus({preventScroll:true});
      }
      function toggleMenu() {
        if (document.body.classList.contains('menu-open')) closeMenu();
        else openMenu();
      }

      btn.addEventListener('click', toggleMenu);
      overlay.addEventListener('click', closeMenu);

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.body.classList.contains('menu-open')) closeMenu();
      });

      nav.addEventListener('click', (e) => {
        const a = e.target.closest('a');
        if (a) closeMenu();
      });
    })();

    // Language switch: mark active & gentle first-visit redirect
    (function(){
      const box = document.querySelector('.lang-switch'); if(!box) return;
      const links = box.querySelectorAll('.lang-link');

      const path = location.pathname;
      const current = /\/de(\/|$)/.test(path) ? 'de' : (/\/en(\/|$)/.test(path) ? 'en' : null);

      // reflect active state
      links.forEach(a => {
        const on = a.dataset.lang === current;
        a.setAttribute('aria-pressed', on ? 'true' : 'false');
        if (on) a.setAttribute('aria-current','true'); else a.removeAttribute('aria-current');
        a.classList.toggle('is-active', on);
      });

      // save preference on click (href handles navigation)
      box.addEventListener('click', e=>{
        const a = e.target.closest('.lang-link'); if(!a) return;
        try{ localStorage.setItem('cw_lang', a.dataset.lang); }catch(_){}
      });

      // first visit without /de/|/en/ → go to saved or browser language
      if(!current){
        let pref = null; try{ pref = localStorage.getItem('cw_lang'); }catch(_){}
        const fallback = (navigator.language||'en').toLowerCase().startsWith('de') ? 'de' : 'en';
        const target = pref || fallback;
        location.replace(`/${target}/`);
      }
    })();
    </script>
  </body>
</html>
